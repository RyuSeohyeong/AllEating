<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="com.spring.alleating.owner.product.dao.OwnerProductDAO">

	<resultMap id="productResult" type="productVO">
		<result property="productId" column="productId" />
		<result property="deliveryType" column="deliveryType" />
		<result property="deliveryPrice" column="deliveryPrice" />
		<result property="cateCode" column="cateCode" />
		<result property="productName" column="productName" />
		<result property="productPrice" column="productPrice" />
		<result property="productDiscount" column="productDiscount" />
		<result property="productSalesPrice" column="productSalesPrice" />
		<result property="productUnit" column="productUnit" />
		<result property="productPackType" column="productPackType" />
		<result property="productWeight" column="productWeight" />
		<result property="productOrigin" column="productOrigin"/>
		<result property="productTotal" column="productTotal"/>
		<result property="productExpireDate" column="productExpireDate"/>
		<result property="productStatus" column="productStatus"/>
		<result property="productBrand" column="productBrand"/>
		<result property="productContentTitle" column="productContentTitle"/>
		<result property="productContent" column="productContent"/>
		<result property="creDate" column="creDate"/>
		<result property="reg_id" column="reg_id"/>
		<result property="join_type" column="join_type" />
	</resultMap>
	
	<resultMap id="productImgResult" type="productImgVO">
		<result property="imgId" column="imgId" />
		<result property="productId" column="productId" />
		<result property="reg_id" column="reg_id" />
		<result property="fileName" column="fileName" />
		<result property="img_type" column="img_type" />
		<result property="creDate" column="creDate" />
	</resultMap>
	
	<!-- select -->
	<select id="selectAllOwnerProductList" resultMap="productResult">
	<![CDATA[
 select * from product where join_type='owner'
 
]]>
	</select>
	
	<!-- insert -->
<insert id="insertNewProduct" parameterType="java.util.Map">
		<selectKey resultType="String" keyProperty="productId"
			order="BEFORE">
			select ifnull(max(productId),0)+1 from product
		</selectKey>
		<![CDATA[
		insert into product(
							productId,
							deliveryType,
							deliveryPrice,
							cateCode,
							productName,
							productPrice,
							productDiscount,
							productSalesPrice,
							productUnit,
							productPackType,
							productWeight,
							productOrigin,
							productTotal,
							productExpireDate,
							productBrand,
							productContentTitle,
							productContent,
							reg_id,
							join_type)
							values(
							#{productId},
							#{deliveryType},
							#{deliveryPrice},
							#{cateCode},
							#{productName},
							#{productPrice},
							#{productDiscount},
							#{productSalesPrice},
							#{productUnit},
							#{productPackType},
							#{productWeight},
							#{productOrigin},
							#{productTotal},
							#{productExpireDate},
							#{productBrand},
							#{productContentTitle},
							#{productContent},
							#{reg_id},
							#{join_type}
							)
			]]>
	</insert>
	
	
	
	<insert id="insertProductImageFile" parameterType="productImgVO">
		
		<selectKey resultType="int" keyProperty="imgId"
			order="BEFORE">
			select ifnull(max(imgId),0)+1 from product_img
		</selectKey>
	 
		   insert into product_img (imgId,
		                                     productId,
									         fileName,
											 fileType,
											 reg_id)
											 values
											 (#{imgId},
											 #{productId},
											 #{fileName},
											 #{fileType},
											 #{reg_id} )
	
	</insert>
	
	<select id="selectproductById" resultType="productVO" parameterType="int">
 	 	select * from product
 	 	where
  		productId=#{productId}
	</select>
	
	<delete id="deleteproduct" parameterType="int">
  		delete from product
  		where
  		productId=#{productId}
 	</delete>
 	
 		<update id="updateproduct" parameterType="java.util.Map">
  		update product
  		set deliveryType=#{deliveryType},
 			deliveryPrice=#{deliveryPrice},
 			cateCode=#{cateCode},
 			productName=#{productName},
 			productPrice=#{productPrice},
  			productDiscount=#{productDiscount},
  			productSalesPrice=#{productSalesPrice},
  			productUnit=#{productUnit},
  			productPackType=#{productPackType},
 			productWeight=#{productWeight},
  			productOrigin=#{productOrigin},
  			productTotal=#{productTotal},
			productExpireDate=#{productExpireDate},
 			productStatus=#{productStatus},
 			productBrand=#{productBrand},
  			productContentTitle=#{productContentTitle},
  			productContent=#{productContent},
  			where
  			productId=#{productId}
    </update>
    
    <update id="updateproductimg" parameterType="productImgVO">
  		update member
  		set productId=#{productId},
  			reg_id=#{reg_id},
  			fileName=#{fileName},
  			fileType=#{fileType},	    
  			where
  			imgId=#{imgId}
    </update>
     
    <select id="productEditdata" resultMap="productResult" parameterType="int">
		<![CDATA[
		select * from product where productId = #{productId}
		]]>
	</select>
	<select id="productEditdataImg" resultMap="productImgResult" parameterType="int">
		<![CDATA[
		select * from product_img where productId = #{productId}
		]]>
	</select>
	
	<!-- <select id="selectproductImageFileList" resultMap="productImgResult"   parameterType="String"  >
	    <![CDATA[
		    	select * from  product_img
		    	where  
			    productId=#{productId}
			    order by imgId asc
    	]]>
	</select> -->
	
</mapper>